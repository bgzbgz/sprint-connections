{
  "nodes": [
    {
      "parameters": {
        "httpMethod": "POST",
        "path": "tool-factory",
        "responseMode": "responseNode",
        "options": {}
      },
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 2.1,
      "position": [
        -832,
        592
      ],
      "id": "853294da-3a7a-4f73-b3ca-6cde8d206d6d",
      "name": "tool-factory",
      "webhookId": "b17aa9c0-88cb-48fe-a0f2-43096c382dea"
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "={{ $json.context.example_tool ? '## REFERENCE EXAMPLE (Score: 98/100)\\n\\nStudy this structure and match its quality:\\n\\n' + $json.context.example_tool + '\\n\\n---\\n\\n' : '' }}## Tool Request\n\n  {{ $json.source }}\n\n  ## Brand Guidelines\n  {{ $json.context.brand_guidelines || 'Use Fast Track brand: bold, direct, action-oriented.' }}\n\n  ## Writing Guide\n  {{ $json.context.writing_guide || 'No hedge words. Short sentences. Action verbs.' }}\n\n  ## 8-Point Criteria\n  {{ $json.context.eight_point_criteria || 'Force decision, zero instructions, instant feedback, gamification, clear verdicts, commitment, Fast Track DNA.' }}\n\n  Generate the complete tool specification in Markdown format. Follow the EXACT structure from the reference example above. Ensure ALL 8 criteria are satisfied.",
        "options": {
          "systemMessage": "You are a Fast Track Tool Architect. You create world-class decision-making tools for elite CEOs (YPO-level, €5M-€500M companies).\n\n## YOUR OUTPUT FORMAT\n\nYou MUST output a complete tool specification in Markdown format. Follow this EXACT structure:\n\n===TOOL_META===\ntool_name: [2-4 words, action-oriented name]\ntool_slug: [lowercase-with-dashes]\ndecision: [The ONE specific decision this tool forces]\ntagline: [Max 8 words, brutal and direct]\nestimated_time: [X minutes - always 3-5 min]\n===END_META===\n\n===COVER===\n# [TOOL NAME IN CAPS]\n\n[Tagline]\n\n[One sentence: What you'll walk away with]\n===END_COVER===\n\n===CONTEXT===\n## Why This Matters\n\n[Paragraph 1: The pain. What happens if they DON'T make this decision? Be brutal.]\n\n[Paragraph 2: The promise. What this tool will reveal. Be specific.]\n===END_CONTEXT===\n\n===DIAGNOSTIC:1===\n## [Section Title - Action Verb + 2-3 words]\n\n**The Question:** [What are we really trying to figure out?]\n\n### INPUT:1.1\n- id: [snake_case_id]\n- label: [Clear, jargon-free label - max 60 chars]\n- type: slider | select | number | matrix | zones\n- required: true\n\n#### For type: slider\n- min: 0\n- max: 100\n- default: 50\n- unit: \"%\" | \"hours\" | \"days\" | \"\"\n- markers: [{ value: 0, label: \"None\" }, { value: 50, label: \"Moderate\" }, { value: 100, label: \"Extreme\" }]\n\n#### For type: select\n- options: [{ value: \"option1\", label: \"Option 1\", score_impact: 10 }, ...]\n\n#### For type: number\n- min: 0\n- max: 100\n- placeholder: \"e.g., 15\"\n\n#### For type: matrix\n- rows: [\"Item 1\", \"Item 2\", \"Item 3\"]\n- columns: [\"Green Zone\", \"Yellow Zone\", \"Red Zone\"]\n- colors: [\"#4ECDC4\", \"#FFF469\", \"#FF6B6B\"]\n\n### FEEDBACK:1.1\n**Instant feedback shown as user interacts:**\n\n- IF value <= 30%:\n  - indicator: red\n  - message: \"[Brutal truth about what this means]\"\n  - insight: \"[Pattern this reveals about their situation]\"\n\n- IF value 31-70%:\n  - indicator: yellow\n  - message: \"[Direct observation]\"\n  - insight: \"[What to pay attention to]\"\n\n- IF value > 70%:\n  - indicator: green\n  - message: \"[Validation with a challenge]\"\n  - insight: \"[What this strength means]\"\n\n### INPUT:1.2\n[Continue with more inputs...]\n\n===END_DIAGNOSTIC===\n\n===DIAGNOSTIC:2===\n[Same structure as DIAGNOSTIC:1]\n===END_DIAGNOSTIC===\n\n===COMMITMENT===\n## Your Commitment\n\n**The Decision:**\n[What specific YES/NO or action must they commit to?]\n\n**Commitment Template:**\n\"I will [ACTION] by [DATE] because my [diagnostic result] shows [INSIGHT].\"\n\n### Fields:\n- action:\n  - type: text\n  - placeholder: \"e.g., Post the job listing for a senior developer\"\n  - validation: min 10 characters, must start with verb\n\n- deadline:\n  - type: date\n  - constraints: must be within 90 days\n  - default: 30 days from today\n\n### Accountability\n- share_prompt: \"Who needs to see this commitment?\"\n- share_options: [\"My team\", \"My manager\", \"My coach\", \"My peer group\"]\n- share_required: true\n===END_COMMITMENT===\n\n===VERDICTS===\n## The Verdict\n\n### SCORE 0-35: [VERDICT NAME - 2 words max]\n- color: #FF6B6B\n- headline: \"[Brutal one-liner]\"\n- explanation: \"[2-3 sentences. What this score means.]\"\n- primary_action: \"[ONE specific thing to do. Verb first. Include timeframe.]\"\n- secondary_actions: [\"[Action 2]\", \"[Action 3]\"]\n\n### SCORE 36-65: [VERDICT NAME]\n- color: #FFF469\n- headline: \"[Direct observation]\"\n- explanation: \"[2-3 sentences]\"\n- primary_action: \"[ONE specific thing]\"\n- secondary_actions: [...]\n\n### SCORE 66-100: [VERDICT NAME]\n- color: #4ECDC4\n- headline: \"[Validation with next challenge]\"\n- explanation: \"[2-3 sentences. Don't let them get complacent.]\"\n- primary_action: \"[The NEXT level challenge]\"\n- secondary_actions: [...]\n===END_VERDICTS===\n\n===SCORING===\n## Score Calculation\n\n### Weights:\n- input_1_1: 3\n- input_1_2: 2\n- input_2_1: 3\n[etc...]\n\n### Formula:\n[Plain English description of how inputs combine]\n===END_SCORING===\n\n## THE 8-POINT CRITERIA (You MUST satisfy ALL)\n\n1. **Forces concrete decision** - Tool ends with YES/NO or specific commitment\n2. **Zero instructions needed** - Labels are self-explanatory\n3. **Easy first steps** - Step 1 has simplest inputs\n4. **Feedback on each input** - Every input has LOW/MID/HIGH feedback\n5. **Gamification** - Progress feels rewarding\n6. **Crystal clear results** - Verdict + specific action\n7. **Public commitment** - Sharing mechanism required\n8. **Fast Track DNA** - Brutal honesty, action verbs, no corporate speak\n\n## FAST TRACK WRITING RULES\n\n- Day-to-day language (NOT corporate speak)\n- Brutal simplicity - short sentences\n- Action verbs - \"Do X\" not \"Consider doing X\"\n- NO hedge words: never use \"might\", \"could\", \"perhaps\", \"maybe\", \"possibly\"\n- Constraint-based clarity - specific numbers, dates, limits\n- €20K premium feel - confident, elite, no fluff\n\n## FORBIDDEN WORDS\nmight, could, perhaps, maybe, possibly, sometimes, often, generally, typically, probably, utilize, leverage, synergy, optimization, stakeholder, bandwidth, paradigm, deliverable, actionable, scalable"
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 3.1,
      "position": [
        448,
        640
      ],
      "id": "a2aeddf2-0869-4d83-b342-472b0463fd24",
      "name": "Tool Architect Agent"
    },
    {
      "parameters": {
        "modelName": "models/gemini-pro-latest",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatGoogleGemini",
      "typeVersion": 1,
      "position": [
        384,
        864
      ],
      "id": "0fac7084-3389-404b-9606-7de38a7d4041",
      "name": "Google Gemini Chat Model",
      "credentials": {
        "googlePalmApi": {
          "id": "xumf2ySItGDEnYce",
          "name": "Google Gemini(PaLM) Api account 5"
        }
      }
    },
    {
      "parameters": {
        "mode": "markdownToHtml",
        "markdown": "={{ $json.sections.cover || '' }}  ---SECTION_BREAK---  {{ $json.sections.context || '' }}  ---SECTION_BREAK---  {{ $json.sections.diagnostic_1 || '' }}  ---SECTION_BREAK---  {{ $json.sections.diagnostic_2 || '' }}  ---SECTION_BREAK---  {{ $json.sections.commitment || '' }}  ---SECTION_BREAK---  {{ $json.sections.verdicts || '' }}",
        "destinationKey": "html_fragments",
        "options": {
          "emoji": true,
          "tasklists": true,
          "simpleLineBreaks": true,
          "strikethrough": true,
          "tables": true
        }
      },
      "type": "n8n-nodes-base.markdown",
      "typeVersion": 1,
      "position": [
        960,
        640
      ],
      "id": "befb32b8-f58a-4cc5-ab24-2aa68afac086",
      "name": "Markdown to HTML"
    },
    {
      "parameters": {
        "html": "<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n  <meta charset=\"UTF-8\">\n  <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n  <title>{{ $json.tool_name }} | Fast Track</title>\n  <style>\n    /* Fast Track Design System v2 */\n    @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap');\n\n    :root {\n      --ft-black: #000000;\n      --ft-white: #FFFFFF;\n      --ft-grey: #B2B2B2;\n      --ft-grey-dark: #1A1A1A;\n      --ft-yellow: #FFF469;\n      --ft-red: #FF6B6B;\n      --ft-green: #4ECDC4;\n    }\n\n    * { box-sizing: border-box; margin: 0; padding: 0; }\n\n    body {\n      font-family: 'Inter', sans-serif;\n      background: var(--ft-black);\n      color: var(--ft-white);\n      line-height: 1.6;\n    }\n\n    .page { display: none; min-height: 100vh; padding: 2rem; }\n    .page.active { display: flex; flex-direction: column; }\n\n    .cover { justify-content: center; align-items: center; text-align: center; }\n    .cover h1 { font-size: clamp(2rem, 8vw, 4rem); text-transform: uppercase; margin-bottom: 1rem; }\n    .cover .tagline { font-size: 1.25rem; color: var(--ft-grey); margin-bottom: 2rem; }\n\n    .btn { padding: 1rem 2rem; border: 3px solid var(--ft-white); background: transparent; color: var(--ft-white); cursor: pointer; text-transform: uppercase; letter-spacing: 0.1em; transition: all 0.2s; font-size: 1rem; }\n    .btn:hover { background: var(--ft-white); color: var(--ft-black); }\n    .btn-primary { background: var(--ft-yellow); border-color: var(--ft-yellow); color: var(--ft-black); }\n\n    .progress-bar { position: fixed; top: 0; left: 0; height: 4px; background: var(--ft-yellow); width: 0%; transition: width 0.3s; }\n\n    .input-group { margin-bottom: 2rem; }\n    .input-label { font-size: 0.75rem; text-transform: uppercase; letter-spacing: 0.1em; color: var(--ft-grey); margin-bottom: 0.5rem; display: block; }\n    .input-field { width: 100%; padding: 1rem; background: transparent; border: 3px solid var(--ft-white); color: var(--ft-white); font-size: 1rem; }\n    .input-field:focus { outline: none; border-color: var(--ft-yellow); }\n\n    .feedback { padding: 1rem; margin-top: 0.5rem; border-left: 4px solid; opacity: 0; transition: opacity 0.3s; }\n    .feedback.show { opacity: 1; }\n    .feedback.red { border-color: var(--ft-red); background: rgba(255,107,107,0.1); }\n    .feedback.yellow { border-color: var(--ft-yellow); background: rgba(255,244,105,0.1); }\n    .feedback.green { border-color: var(--ft-green); background: rgba(78,205,196,0.1); }\n\n    .score-display { text-align: center; padding: 2rem 0; }\n    .score-number { font-size: 6rem; font-weight: bold; line-height: 1; }\n    .verdict-name { font-size: 2rem; text-transform: uppercase; margin-top: 1rem; }\n\n    .commitment-box { border: 3px solid var(--ft-yellow); padding: 2rem; margin: 2rem 0; }\n    .commitment-input { width: 100%; padding: 1rem; background: transparent; border: none; border-bottom: 2px solid var(--ft-white); color: var(--ft-white); font-size: 1.25rem; }\n\n    .share-section { display: flex; gap: 1rem; justify-content: center; margin-top: 2rem; flex-wrap: wrap; }\n\n    .container { max-width: 800px; margin: 0 auto; width: 100%; }\n  </style>\n</head>\n<body>\n  <div class=\"progress-bar\" id=\"progressBar\"></div>\n\n  <!-- Cover Page -->\n  <div class=\"page cover active\" id=\"cover\">\n    <h1>{{ $json.tool_name }}</h1>\n    <p class=\"tagline\">{{ $json.tagline }}</p>\n    <p style=\"color: var(--ft-grey); margin-bottom: 2rem;\">{{ $json.estimated_time }}</p>\n    <button class=\"btn btn-primary\" onclick=\"showPage('context')\">START</button>\n  </div>\n\n  <!-- Context Page -->\n  <div class=\"page\" id=\"context\">\n    <div class=\"container\">\n      <h2 style=\"margin-bottom: 1rem;\">{{ $json.decision }}</h2>\n      <div id=\"contextContent\"></div>\n      <button class=\"btn btn-primary\" onclick=\"showPage('step-1')\" style=\"margin-top: 2rem;\">BEGIN</button>\n    </div>\n  </div>\n\n  <!-- Diagnostic Steps - Generated Dynamically -->\n  <div class=\"page\" id=\"step-1\">\n    <div class=\"container\">\n      <div id=\"step1Content\"></div>\n      <button class=\"btn btn-primary\" onclick=\"showPage('step-2')\" style=\"margin-top: 2rem;\">NEXT</button>\n    </div>\n  </div>\n\n  <div class=\"page\" id=\"step-2\">\n    <div class=\"container\">\n      <div id=\"step2Content\"></div>\n      <button class=\"btn btn-primary\" onclick=\"showPage('commitment')\" style=\"margin-top: 2rem;\">NEXT</button>\n    </div>\n  </div>\n\n  <!-- Commitment Page -->\n  <div class=\"page\" id=\"commitment\">\n    <div class=\"container\">\n      <h2 style=\"margin-bottom: 2rem;\">YOUR COMMITMENT</h2>\n      <div class=\"commitment-box\">\n        <label class=\"input-label\">I commit to:</label>\n        <input type=\"text\" class=\"commitment-input\" id=\"commitmentText\" placeholder=\"I will [ACTION] by [DATE] because [REASON]\">\n      </div>\n      <div style=\"margin-bottom: 2rem;\">\n        <label class=\"input-label\">Deadline</label>\n        <input type=\"date\" class=\"input-field\" id=\"commitmentDeadline\" style=\"max-width: 300px;\">\n      </div>\n      <button class=\"btn btn-primary\" onclick=\"showPage('results')\">SEAL IT</button>\n    </div>\n  </div>\n\n  <!-- Results Page -->\n  <div class=\"page\" id=\"results\">\n    <div class=\"container\">\n      <div class=\"score-display\">\n        <div class=\"score-number\" id=\"scoreNumber\">--</div>\n        <div class=\"verdict-name\" id=\"verdictName\">CALCULATING</div>\n      </div>\n      <p id=\"verdictHeadline\" style=\"text-align: center; font-size: 1.25rem; margin-bottom: 1rem;\"></p>\n      <p id=\"verdictExplanation\" style=\"text-align: center; color: var(--ft-grey); margin-bottom: 2rem;\"></p>\n      <div id=\"primaryAction\" style=\"border: 3px solid var(--ft-yellow); padding: 1.5rem; margin-bottom: 2rem;\">\n        <p style=\"font-size: 0.75rem; text-transform: uppercase; color: var(--ft-yellow); margin-bottom: 0.5rem;\">Your Next Move</p>\n        <p id=\"primaryActionText\" style=\"font-size: 1.25rem; font-weight: bold;\"></p>\n      </div>\n      <div class=\"share-section\">\n        <button class=\"btn\" onclick=\"resetTool()\">START OVER</button>\n        <button class=\"btn btn-primary\" onclick=\"shareWithTeam()\">SHARE WITH TEAM</button>\n        <button class=\"btn\" onclick=\"window.print()\">EXPORT PDF</button>\n      </div>\n    </div>\n  </div>\n\n  <script>\n    // Tool Configuration\n    const TOOL = {\n      name: '{{ $json.tool_name }}',\n      inputs: {{ JSON.stringify($json.inputs) }},\n      feedback: {{ JSON.stringify($json.feedback) }},\n      verdicts: {{ JSON.stringify($json.verdicts) }},\n      weights: {{ JSON.stringify($json.scoring_weights) }}\n    };\n\n    let state = { inputs: {}, currentPage: 'cover' };\n\n    function showPage(id) {\n      document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));\n      document.getElementById(id).classList.add('active');\n      state.currentPage = id;\n      updateProgress();\n      if (id === 'results') calculateResults();\n    }\n\n    function updateProgress() {\n      const pages = ['cover', 'context', 'step-1', 'step-2', 'commitment', 'results'];\n      const idx = pages.indexOf(state.currentPage);\n      const progress = (idx / (pages.length - 1)) * 100;\n      document.getElementById('progressBar').style.width = progress + '%';\n    }\n\n    function handleInput(inputId, value, max) {\n      state.inputs[inputId] = value;\n      const percent = (value / max) * 100;\n      const fb = TOOL.feedback[inputId];\n      if (!fb) return;\n\n      const el = document.getElementById('feedback-' + inputId);\n      if (!el) return;\n\n      el.classList.remove('red', 'yellow', 'green');\n      el.classList.add('show');\n\n      let level;\n      if (percent <= 30) { level = fb.low; el.classList.add('red'); }\n      else if (percent <= 70) { level = fb.mid; el.classList.add('yellow'); }\n      else { level = fb.high; el.classList.add('green'); }\n\n      el.innerHTML = '<strong>' + (level.message || '') + '</strong><br><em style=\"color: var(--ft-grey);\">' + (level.insight || '') + '</em>';\n    }\n\n    function calculateResults() {\n      let total = 0, weightSum = 0;\n      Object.keys(state.inputs).forEach(id => {\n        const weight = TOOL.weights[id] || 1;\n        const config = TOOL.inputs[id];\n        const max = config?.max || 100;\n        const percent = (state.inputs[id] / max) * 100;\n        total += percent * weight;\n        weightSum += weight;\n      });\n\n      const score = weightSum > 0 ? Math.round(total / weightSum) : 50;\n      const verdict = TOOL.verdicts.find(v => score >= v.min && score <= v.max) || TOOL.verdicts[1];\n\n      document.getElementById('scoreNumber').textContent = score;\n      document.getElementById('scoreNumber').style.color = verdict.color;\n      document.getElementById('verdictName').textContent = verdict.name;\n      document.getElementById('verdictName').style.color = verdict.color;\n      document.getElementById('verdictHeadline').textContent = verdict.headline;\n      document.getElementById('verdictExplanation').textContent = verdict.explanation;\n      document.getElementById('primaryActionText').textContent = verdict.primary_action;\n    }\n\n    function resetTool() {\n      state.inputs = {};\n      document.querySelectorAll('.input-field').forEach(i => i.value = '');\n      document.querySelectorAll('.feedback').forEach(f => f.classList.remove('show'));\n      showPage('cover');\n    }\n\n    function shareWithTeam() {\n      const commitment = document.getElementById('commitmentText').value;\n      const score = document.getElementById('scoreNumber').textContent;\n      const verdict = document.getElementById('verdictName').textContent;\n      alert('Sharing:\\\\n\\\\nTool: ' + TOOL.name + '\\\\nScore: ' + score + '\\\\nVerdict: ' + verdict + '\\\\nCommitment: ' + commitment);\n    }\n\n    // Initialize deadline default (30 days)\n    document.addEventListener('DOMContentLoaded', function() {\n      const deadline = document.getElementById('commitmentDeadline');\n      if (deadline) {\n        const d = new Date();\n        d.setDate(d.getDate() + 30);\n        deadline.valueAsDate = d;\n      }\n    });\n  </script>\n</body>\n</html>"
      },
      "type": "n8n-nodes-base.html",
      "typeVersion": 1.2,
      "position": [
        1168,
        640
      ],
      "id": "0552fdf4-6175-4651-a8b2-b55605ace882",
      "name": "Build HTML Template"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 3
          },
          "conditions": [
            {
              "id": "2b342d3a-dd1e-4dd7-a63e-e5b40c7dfdfc",
              "leftValue": "={{ $json.qa_passed }}",
              "rightValue": "",
              "operator": {
                "type": "boolean",
                "operation": "true",
                "singleValue": true
              }
            },
            {
              "id": "a3c24c6f-6ac6-4773-8c34-86f2b71ea01d",
              "leftValue": "={{ $json.qa_passed }}",
              "rightValue": "",
              "operator": {
                "type": "boolean",
                "operation": "false",
                "singleValue": true
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.3,
      "position": [
        1872,
        800
      ],
      "id": "cbee3950-fc51-439d-a416-0c8753acb1f6",
      "name": "If"
    },
    {
      "parameters": {
        "operation": "insert",
        "collection": "tools",
        "fields": "={\n  \"tool_id\": \"{{ $json.job_id }}\",\n  \"tool_name\": \"{{ $json.tool_name }}\",\n  \"tool_slug\": \"{{ $json.tool_slug }}\",\n  \"tool_html\": \"{{ $json.tool_html }}\",\n  \"decision\": \"{{ $json.decision }}\",\n  \"tagline\": \"{{ $json.tagline }}\",\n  \"qa_score\": {{ $json.qa_score }},\n  \"qa_report\": {{ JSON.stringify($json.qa_report) }},\n  \"revision_count\": {{ $json.attempt }},\n  \"revision_history\": {{ JSON.stringify($json.revision_history || []) }},\n  \"created_at\": \"{{ new Date().toISOString() }}\",\n  \"status\": \"active\"\n}",
        "options": {}
      },
      "type": "n8n-nodes-base.mongoDb",
      "typeVersion": 1.2,
      "position": [
        2240,
        272
      ],
      "id": "3905f5cf-0281-432a-bb2b-2a5fee127dd6",
      "name": "Insert documents",
      "credentials": {
        "mongoDb": {
          "id": "g6FogqsZFxtd6Brl",
          "name": "tools system"
        }
      }
    },
    {
      "parameters": {
        "respondWith": "json",
        "responseBody": "={\n  \"success\": true,\n  \"job_id\": \"{{ $json.job_id }}\",\n  \"tool_name\": \"{{ $json.tool_name }}\",\n  \"tool_description\": \"{{ $json.tagline }}\",\n  \"tool_html_base64\": \"{{ Buffer.from($json.tool_html || '').toString('base64') }}\",\n  \"qa_report\": {{ JSON.stringify($json.qa_report) }},\n  \"revision_count\": {{ $json.attempt }},\n  \"revision_history\": {{ JSON.stringify($json.revision_history || []) }}\n}",
        "options": {}
      },
      "type": "n8n-nodes-base.respondToWebhook",
      "typeVersion": 1.5,
      "position": [
        2448,
        272
      ],
      "id": "c2a1d17c-71db-4df9-bccd-74dd8ebddb30",
      "name": "Respond to Webhook"
    },
    {
      "parameters": {
        "jsCode": " // Merge all context for AI agent\n  const input = $('Parse & Normalize Input').first().json;\n  const brand = $('MongoDB - Brand Guidelines').first().json;\n  const writing = $('MongoDB - Writing Guide').first().json;\n  const criteria = $('MongoDB - 8 Point Criteria').first().json;\n\n  // NEW: Fetch example tool\n  let example = '';\n  try {\n    const exampleDoc = $('MongoDB - Tool Example').first().json;\n    example = exampleDoc?.markdown || '';\n  } catch (e) {\n    example = '';\n  }\n\n  return [{\n    json: {\n      ...input,\n      context: {\n        brand_guidelines: brand?.content || '',\n        writing_guide: writing?.content || '',\n        eight_point_criteria: criteria?.content || '',\n        example_tool: example  // NEW\n      }\n    }\n  }];"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -304,
        1280
      ],
      "id": "36be161f-86f7-47b6-b0db-ff1aa4bdb87e",
      "name": "Merge Context"
    },
    {
      "parameters": {
        "collection": "three_principles",
        "options": {},
        "query": "={\"category\": \"brand_guidelines\"}"
      },
      "type": "n8n-nodes-base.mongoDb",
      "typeVersion": 1.2,
      "position": [
        -608,
        784
      ],
      "id": "6d8c02b7-4083-4915-aeec-9ed6cada1cb2",
      "name": "MongoDB - Brand Guidelines",
      "credentials": {
        "mongoDb": {
          "id": "g6FogqsZFxtd6Brl",
          "name": "tools system"
        }
      }
    },
    {
      "parameters": {
        "collection": "three_principles",
        "options": {
          "limit": 10
        },
        "query": "={\"category\": \"writing_guides\"}"
      },
      "type": "n8n-nodes-base.mongoDb",
      "typeVersion": 1.2,
      "position": [
        -608,
        1104
      ],
      "id": "e9ee0082-7d79-446a-bddc-88a18ca7e11b",
      "name": "MongoDB - Writing Guide",
      "credentials": {
        "mongoDb": {
          "id": "g6FogqsZFxtd6Brl",
          "name": "tools system"
        }
      }
    },
    {
      "parameters": {
        "collection": "three_principles",
        "options": {
          "limit": 10
        },
        "query": "={\"subcategory\": \"8_point_criteria\"}"
      },
      "type": "n8n-nodes-base.mongoDb",
      "typeVersion": 1.2,
      "position": [
        -608,
        944
      ],
      "id": "3ada9bc0-228e-4e82-bb84-5cada4fbdba0",
      "name": "MongoDB - 8 Point Criteria",
      "credentials": {
        "mongoDb": {
          "id": "g6FogqsZFxtd6Brl",
          "name": "tools system"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "// Parse AI-generated Markdown into sections\nconst input = $('Merge Context').first().json;\nconst markdown = $('Tool Architect Agent').first().json.output;\n\n// Extract metadata\nconst metaMatch = markdown.match(/===TOOL_META===([\\s\\S]*?)===END_META===/);\nlet meta = {};\nif (metaMatch) {\n  metaMatch[1].split('\\n').forEach(line => {\n    const [key, ...rest] = line.split(':');\n    if (key && rest.length) {\n      meta[key.trim()] = rest.join(':').trim();\n    }\n  });\n}\n\n// Extract each section\nconst sections = {};\nconst sectionTypes = ['COVER', 'CONTEXT', 'DIAGNOSTIC:1', 'DIAGNOSTIC:2', 'DIAGNOSTIC:3', 'COMMITMENT', 'VERDICTS', 'SCORING'];\n\nsectionTypes.forEach(type => {\n  const regex = new RegExp(`===${type}===([\\\\s\\\\S]*?)===END_${type.split(':')[0]}===`);\n  const match = markdown.match(regex);\n  if (match) {\n    const key = type.toLowerCase().replace(':', '_');\n    sections[key] = match[1].trim();\n  }\n});\n\n// Count diagnostics\nconst diagnosticCount = Object.keys(sections).filter(k => k.startsWith('diagnostic')).length;\n\n// Parse inputs from diagnostics\nconst inputs = {};\nconst feedback = {};\nconst inputRegex = /### INPUT:(\\d+\\.\\d+)([\\s\\S]*?)(?=### INPUT:|### FEEDBACK:|===END)/g;\nconst feedbackRegex = /### FEEDBACK:(\\d+\\.\\d+)([\\s\\S]*?)(?=### INPUT:|### FEEDBACK:|===END)/g;\n\nlet inputMatch;\nwhile ((inputMatch = inputRegex.exec(markdown)) !== null) {\n  const id = `input_${inputMatch[1].replace('.', '_')}`;\n  inputs[id] = parseInputConfig(inputMatch[2]);\n}\n\nlet feedbackMatch;\nwhile ((feedbackMatch = feedbackRegex.exec(markdown)) !== null) {\n  const id = `input_${feedbackMatch[1].replace('.', '_')}`;\n  feedback[id] = parseFeedbackConfig(feedbackMatch[2]);\n}\n\n// Parse verdicts\nconst verdicts = parseVerdicts(sections.verdicts || '');\n\n// Parse scoring weights\nconst scoringWeights = parseScoringWeights(sections.scoring || '');\n\nfunction parseInputConfig(text) {\n  const config = {};\n  const lines = text.split('\\n');\n  lines.forEach(line => {\n    const match = line.match(/^- (\\w+): (.+)$/);\n    if (match) {\n      let value = match[2].trim();\n      // Parse arrays/objects\n      if (value.startsWith('[') || value.startsWith('{')) {\n        try { value = JSON.parse(value); } catch (e) {}\n      }\n      config[match[1]] = value;\n    }\n  });\n  return config;\n}\n\nfunction parseFeedbackConfig(text) {\n  const config = { low: {}, mid: {}, high: {} };\n  const sections = text.split(/- IF value/);\n  sections.forEach(section => {\n    if (section.includes('<= 30%')) {\n      config.low = extractFeedbackValues(section);\n    } else if (section.includes('31-70%')) {\n      config.mid = extractFeedbackValues(section);\n    } else if (section.includes('> 70%')) {\n      config.high = extractFeedbackValues(section);\n    }\n  });\n  return config;\n}\n\nfunction extractFeedbackValues(text) {\n  const result = {};\n  const messageMatch = text.match(/message: \"([^\"]+)\"/);\n  const insightMatch = text.match(/insight: \"([^\"]+)\"/);\n  const indicatorMatch = text.match(/indicator: (\\w+)/);\n  if (messageMatch) result.message = messageMatch[1];\n  if (insightMatch) result.insight = insightMatch[1];\n  if (indicatorMatch) result.indicator = indicatorMatch[1];\n  return result;\n}\n\nfunction parseVerdicts(text) {\n  const verdicts = [];\n  const verdictRegex = /### SCORE (\\d+)-(\\d+): ([^\\n]+)([\\s\\S]*?)(?=### SCORE|$)/g;\n  let match;\n  while ((match = verdictRegex.exec(text)) !== null) {\n    const verdict = {\n      min: parseInt(match[1]),\n      max: parseInt(match[2]),\n      name: match[3].trim(),\n      color: '',\n      headline: '',\n      explanation: '',\n      primary_action: '',\n      secondary_actions: []\n    };\n    const content = match[4];\n    const colorMatch = content.match(/color: (#[A-Fa-f0-9]+)/);\n    const headlineMatch = content.match(/headline: \"([^\"]+)\"/);\n    const explanationMatch = content.match(/explanation: \"([^\"]+)\"/);\n    const primaryMatch = content.match(/primary_action: \"([^\"]+)\"/);\n    const secondaryMatch = content.match(/secondary_actions: \\[([^\\]]+)\\]/);\n\n    if (colorMatch) verdict.color = colorMatch[1];\n    if (headlineMatch) verdict.headline = headlineMatch[1];\n    if (explanationMatch) verdict.explanation = explanationMatch[1];\n    if (primaryMatch) verdict.primary_action = primaryMatch[1];\n    if (secondaryMatch) {\n      verdict.secondary_actions = secondaryMatch[1].split(',').map(s => s.replace(/\"/g, '').trim());\n    }\n    verdicts.push(verdict);\n  }\n  return verdicts;\n}\n\nfunction parseScoringWeights(text) {\n  const weights = {};\n  const weightRegex = /- (input_\\d+_\\d+): (\\d+)/g;\n  let match;\n  while ((match = weightRegex.exec(text)) !== null) {\n    weights[match[1]] = parseInt(match[2]);\n  }\n  return weights;\n}\n\nreturn [{\n  json: {\n    job_id: input.job_id,\n    attempt: input.attempt,\n    max_attempts: input.max_attempts,\n    callback_url: input.callback_url,\n    tool_name: meta.tool_name || 'Decision Tool',\n    tool_slug: meta.tool_slug || 'decision-tool',\n    decision: meta.decision || '',\n    tagline: meta.tagline || '',\n    estimated_time: meta.estimated_time || '5 minutes',\n    sections,\n    diagnostic_count: diagnosticCount,\n    inputs,\n    feedback,\n    verdicts,\n    scoring_weights: scoringWeights,\n    raw_markdown: markdown\n  }\n}];"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        752,
        640
      ],
      "id": "78b4daf0-7923-4362-9a78-c3fe97ee1475",
      "name": "Parse Markdown Sections"
    },
    {
      "parameters": {
        "jsCode": "// QA Validator - Checks 8-Point Criteria\n  // Returns detailed feedback for Worker if validation fails\n\n  const data = $input.first().json;\n\n  // Defensive check - if parse failed, reject with instructions\n  if (!data || !data.raw_markdown) {\n    return [{\n      json: {\n        passed: false,\n        score: 0,\n        job_id: data?.job_id || 'unknown',\n        attempt: data?.attempt || 1,\n        failures: ['AI output could not be parsed - no raw_markdown found'],\n        fixes: [{\n          location: 'AI Agent Output',\n          current: 'Empty or malformed response',\n          suggestion: 'Ensure AI outputs markdown with ===TOOL_META===...===END_META=== sections',\n          reason: 'Parser requires specific section markers'\n        }]\n      }\n    }];\n  }\n\n  const markdown = data.raw_markdown || '';\n  const toolName = data.tool_name || '';\n  const sections = data.sections || {};\n  const inputs = data.inputs || {};\n  const feedback = data.feedback || {};\n\n  let score = 100;\n  const checks = [];\n  const failures = [];\n  const fixes = [];\n\n  // ===== CHECK 1: Decision Clarity (20 pts) =====\n  const check1 = { name: 'Decision Clarity', points: 20, issues: [] };\n\n  // Tool name exists and has decision word\n  if (!toolName) {\n    check1.points -= 10;\n    check1.issues.push('Tool name missing or empty');\n    failures.push('NO TOOL NAME - Cannot identify tool');\n    fixes.push({\n      location: 'TOOL_META section',\n      current: 'Missing',\n      suggestion: 'Add tool_name: [Decision Canvas Name]',\n      reason: 'Every tool needs a clear name'\n    });\n  } else {\n    const decisionWords = ['decision', 'canvas', 'diagnostic', 'chooser', 'finder', 'assessment', 'analyzer'];\n    const hasDecisionWord = decisionWords.some(w => toolName.toLowerCase().includes(w));\n    if (!hasDecisionWord) {\n      check1.points -= 5;\n      check1.issues.push('Tool name missing decision-oriented word');\n      fixes.push({\n        location: 'TOOL_META.tool_name',\n        current: toolName,\n        suggestion: `${toolName} Decision Canvas`,\n        reason: 'Decision-oriented names set expectations'\n      });\n    }\n  }\n\n  // Has commitment section\n  if (!sections.commitment) {\n    check1.points -= 15;\n    check1.issues.push('Missing COMMITMENT section');\n    failures.push('NO COMMITMENT SECTION - Tool cannot force decision');\n    fixes.push({\n      location: 'After VERDICTS section',\n      suggestion: 'Add ===COMMITMENT=== section with commitment template and deadline',\n      reason: 'Commitment + accountability makes tools effective'\n    });\n  }\n\n  checks.push(check1);\n  score -= (20 - check1.points);\n\n  // ===== CHECK 2: Zero Instructions Needed (15 pts) =====\n  const check2 = { name: 'Zero Instructions', points: 15, issues: [] };\n\n  const jargon = ['utilize', 'leverage', 'synergy', 'optimization', 'stakeholder', 'bandwidth', 'paradigm'];\n  const foundJargon = jargon.filter(w => markdown.toLowerCase().includes(w));\n  if (foundJargon.length > 0) {\n    check2.points -= 5;\n    check2.issues.push(`Jargon found: ${foundJargon.join(', ')}`);\n    fixes.push({\n      location: 'Throughout tool',\n      current: foundJargon.join(', '),\n      suggestion: 'Replace with day-to-day language',\n      examples: { 'utilize': 'use', 'leverage': 'use', 'bandwidth': 'time' }\n    });\n  }\n\n  const visualTypes = ['matrix', 'zones', 'slider'];\n  const hasVisual = visualTypes.some(t => markdown.includes(`type: ${t}`));\n  if (!hasVisual) {\n    check2.points -= 5;\n    check2.issues.push('No visual input types');\n    fixes.push({\n      location: 'DIAGNOSTIC sections',\n      suggestion: 'Add at least one slider, matrix, or zones input',\n      reason: 'Visual inputs are self-explanatory'\n    });\n  }\n\n  checks.push(check2);\n  score -= (15 - check2.points);\n\n  // ===== CHECK 3: Instant Feedback (20 pts) =====\n  const check3 = { name: 'Instant Feedback', points: 20, issues: [] };\n\n  const inputCount = Object.keys(inputs).length;\n  const feedbackCount = Object.keys(feedback).length;\n\n  if (inputCount === 0) {\n    check3.points -= 20;\n    check3.issues.push('No inputs found');\n    failures.push('NO INPUTS DETECTED - Tool needs diagnostic questions');\n    fixes.push({\n      location: 'DIAGNOSTIC sections',\n      suggestion: 'Add ===DIAGNOSTIC:1=== with ### INPUT:1.1 blocks',\n      reason: 'Tools need inputs to gather data for scoring'\n    });\n  } else if (feedbackCount < inputCount) {\n    const missing = inputCount - feedbackCount;\n    check3.points -= (missing * 5);\n    check3.issues.push(`${missing} inputs missing feedback`);\n    fixes.push({\n      location: 'DIAGNOSTIC sections',\n      current: `${feedbackCount}/${inputCount} inputs have feedback`,\n      suggestion: 'Add FEEDBACK block for EVERY input',\n      template: '### FEEDBACK:X.Y with LOW/MID/HIGH messages'\n    });\n  }\n\n  checks.push(check3);\n  score -= (20 - check3.points);\n\n  // ===== CHECK 4: Has Verdicts (15 pts) =====\n  const check4 = { name: 'Result Verdicts', points: 15, issues: [] };\n\n  const verdicts = data.verdicts || [];\n  if (verdicts.length < 3) {\n    check4.points -= 15;\n    check4.issues.push(`Only ${verdicts.length} verdict ranges (need 3)`);\n    failures.push('INCOMPLETE VERDICTS - Need LOW/MID/HIGH score ranges');\n    fixes.push({\n      location: 'VERDICTS section',\n      suggestion: 'Add 3 verdict ranges: 0-35 (red), 36-65 (yellow), 66-100 (green)',\n      reason: 'Users need clear interpretation of their score'\n    });\n  }\n\n  checks.push(check4);\n  score -= (15 - check4.points);\n\n  // ===== CHECK 5: Has Scoring Logic (15 pts) =====\n  const check5 = { name: 'Scoring Logic', points: 15, issues: [] };\n\n  if (!sections.scoring) {\n    check5.points -= 15;\n    check5.issues.push('Missing SCORING section');\n    failures.push('NO SCORING LOGIC - Cannot calculate results');\n    fixes.push({\n      location: 'After DIAGNOSTICS',\n      suggestion: 'Add ===SCORING=== section with weights and formula',\n      reason: 'Scoring logic determines the verdict'\n    });\n  }\n\n  checks.push(check5);\n  score -= (15 - check5.points);\n\n  // ===== CHECK 6: Fast Track DNA (15 pts) =====\n  const check6 = { name: 'Fast Track DNA', points: 15, issues: [] };\n\n  const hedgeWords = ['might', 'could', 'perhaps', 'maybe', 'possibly', 'sometimes'];\n  const foundHedge = hedgeWords.filter(w => markdown.toLowerCase().includes(w));\n  if (foundHedge.length > 0) {\n    check6.points -= (foundHedge.length * 3);\n    check6.issues.push(`Hedge words found: ${foundHedge.join(', ')}`);\n    fixes.push({\n      location: 'Throughout tool',\n      current: foundHedge.join(', '),\n      suggestion: 'Remove ALL hedge words. Be direct.',\n      reason: 'Fast Track DNA = brutal clarity, no hedging'\n    });\n  }\n\n  checks.push(check6);\n  score -= (15 - check6.points);\n\n  // Ensure score stays within bounds\n  score = Math.max(0, Math.min(100, score));\n\n  // Determine pass/fail (threshold: 70)\n  const passed = score >= 70 && failures.length === 0;\n\n  return [{\n    json: {\n      passed,\n      score,\n      job_id: data.job_id,\n      attempt: data.attempt || 1,\n      max_attempts: data.max_attempts || 3,\n      tool_name: toolName,\n      checks,\n      failures,\n      fixes,\n      // Pass through data needed for next steps\n      raw_markdown: markdown,\n      sections,\n      inputs,\n      feedback,\n      verdicts: data.verdicts || [],\n      meta: data.meta || {},\n      callback_url: data.callback_url\n    }\n  }];"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        1648,
        640
      ],
      "id": "cdec58d3-a6b1-47e1-9df0-ed650e3fda26",
      "name": "QA Validator"
    },
    {
      "parameters": {
        "jsCode": "// Prepare Retry - Build context for Revision Agent\n  const qa = $input.first().json;\n\n  // Get the HTML that was built\n  let html = '';\n  try {\n    html = $('Build HTML Template').first().json.html || '';\n  } catch (e) {\n    html = qa.raw_html || '';\n  }\n\n  // Get the example for reference\n  let example = '';\n  try {\n    example = $('MongoDB - Tool Example').first().json.markdown || '';\n  } catch (e) {\n    example = '';\n  }\n\n  // Check if we've exceeded max attempts\n  if (qa.attempt >= qa.max_attempts) {\n    return [{\n      json: {\n        abort: true,\n        abort_reason: `Tool failed QA after ${qa.max_attempts} attempts`,\n        job_id: qa.job_id,\n        final_score: qa.score,\n        tool_name: qa.tool_name,\n        callback_url: qa.callback_url,\n        html: html\n      }\n    }];\n  }\n\n  // Build revision instructions\n  let instructions = `**Score: ${qa.score}/100** (Need 70+ to pass)\\n\\n`;\n\n  if (qa.failures && qa.failures.length > 0) {\n    instructions += `### CRITICAL FAILURES\\n`;\n    qa.failures.forEach((f, i) => {\n      instructions += `${i + 1}. ${f}\\n`;\n    });\n    instructions += `\\n`;\n  }\n\n  if (qa.fixes && qa.fixes.length > 0) {\n    instructions += `### REQUIRED FIXES\\n\\n`;\n    qa.fixes.forEach((fix, i) => {\n      instructions += `**${i + 1}. ${fix.location}**\\n`;\n      if (fix.current) instructions += `- Problem: ${fix.current}\\n`;\n      instructions += `- Fix: ${fix.suggestion}\\n`;\n      if (fix.reason) instructions += `- Why: ${fix.reason}\\n`;\n      instructions += `\\n`;\n    });\n  }\n\n  return [{\n    json: {\n      job_id: qa.job_id,\n      attempt: qa.attempt + 1,\n      max_attempts: qa.max_attempts,\n      revision_instructions: instructions,\n      html: html,\n      example_tool: example,  // NEW: Pass example to Revision Agent\n      callback_url: qa.callback_url,\n      previous_score: qa.score,\n      tool_name: qa.tool_name\n    }\n  }];"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        1984,
        1072
      ],
      "id": "11c9eb5d-d06c-4020-aab5-906a32c2e442",
      "name": "Prepare Retry"
    },
    {
      "parameters": {
        "jsCode": "// Parse & Normalize Input - handles n8n webhook wrapper\n  // Data comes in $input.first().json.body for webhooks\n\n  const raw = $input.first().json;\n\n  // n8n webhooks wrap payload in 'body'\n  const input = raw.body || raw;\n\n  // Extract job_id\n  const job_id = input.job_id || `job_${Date.now()}`;\n\n  // Extract instruction text - check multiple possible locations\n  const source = input.source?.text || input.source || input.instruction_text || input.text || '';\n\n  // Validate we have something to work with\n  if (!source || source.length < 10) {\n    return [{\n      json: {\n        success: false,\n        error: 'Missing or invalid instruction text',\n        job_id: job_id,\n        debug_received: {\n          has_body: !!raw.body,\n          body_keys: raw.body ? Object.keys(raw.body) : [],\n          raw_keys: Object.keys(raw),\n          source_type: typeof input.source,\n          source_preview: String(source).substring(0, 100)\n        }\n      }\n    }];\n  }\n\n  const callback_url = input.callback_url || null;\n  const metadata = input.metadata || {};\n\n  return [{\n    json: {\n      job_id,\n      source,\n      callback_url,\n      metadata,\n      attempt: 1,\n      max_attempts: 3\n    }\n  }];"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -624,
        592
      ],
      "id": "40773e43-6081-4cfa-82b7-043395646db3",
      "name": "Parse & Normalize Input"
    },
    {
      "parameters": {
        "modelName": "models/gemini-pro-latest",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatGoogleGemini",
      "typeVersion": 1,
      "position": [
        2160,
        1328
      ],
      "id": "b37c7cb1-8de1-402e-b074-2d9dc0ab4237",
      "name": "Google Gemini Chat Model1",
      "credentials": {
        "googlePalmApi": {
          "id": "xumf2ySItGDEnYce",
          "name": "Google Gemini(PaLM) Api account 5"
        }
      }
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "=## QA REVISION REQUEST\n\n  ### QA FEEDBACK (MUST FIX ALL)\n  {{ $json.revision_instructions }}\n\n  ### CURRENT TOOL HTML (Reference)\n  {{ $('Build HTML Template').item.json.html }}\n\n  {{ $json.example_tool ? '\\n\\n### REFERENCE EXAMPLE (Study this structure)\\n' + $json.example_tool : '' }}\n\n  Output the COMPLETE REVISED tool in markdown format. Fix ALL issues listed above.",
        "options": {
          "systemMessage": "You are a Fast Track Tool Revision Specialist. Your job is to FIX tools that failed QA validation.\n\n  You will receive:\n  1. The current HTML tool that failed QA\n  2. The SPECIFIC issues and fixes required\n\n  ## YOUR OUTPUT\n\n  Output a COMPLETE revised tool specification in MARKDOWN format using the exact same structure:\n\n  ===TOOL_META===\n  tool_name: [name]\n  tool_slug: [slug]\n  decision: [decision]\n  tagline: [tagline]\n  ===END_META===\n\n  ===COVER===\n  # [TITLE]\n  [content]\n  ===END_COVER===\n\n  ===CONTEXT===\n  [content]\n  ===END_CONTEXT===\n\n  ===DIAGNOSTIC:1===\n  [step 1 inputs and feedback]\n  ===END_DIAGNOSTIC===\n\n  ===VERDICTS===\n  [3 verdict ranges: 0-35, 36-65, 66-100]\n  ===END_VERDICTS===\n\n  ===SCORING===\n  [scoring logic]\n  ===END_SCORING===\n\n  ===COMMITMENT===\n  [commitment section]\n  ===END_COMMITMENT===\n\n  ## RULES\n  1. Fix ALL issues from QA feedback\n  2. Keep what's working - don't break good sections\n  3. Every INPUT needs a FEEDBACK block\n  4. NO hedge words: might, could, perhaps, maybe, possibly\n  5. Output ONLY the markdown - no explanations"
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 3.1,
      "position": [
        2192,
        1072
      ],
      "id": "ef0e55b9-06c3-4f7c-bced-c4b164b9841f",
      "name": "Revision Agent 0"
    },
    {
      "parameters": {
        "mode": "markdownToHtml",
        "markdown": "={{ $json.output }}",
        "destinationKey": "html",
        "options": {}
      },
      "type": "n8n-nodes-base.markdown",
      "typeVersion": 1,
      "position": [
        2784,
        1312
      ],
      "id": "e4b18401-df74-4a79-b1a6-acd1df682d75",
      "name": "MD to HTML - Revision"
    },
    {
      "parameters": {
        "html": " <!DOCTYPE html>                                                                                                                                                                                                                                                                                                      <html lang=\"en\">\n  <head>                                                                                                                                                                                                                                                                                                                 <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title> {{ $json.tool_name }} | Fast Track</title>\n    <style>\n      :root {\n        --ft-black: #000000;\n        --ft-white: #FFFFFF;\n        --ft-red: #FF6B6B;\n        --ft-yellow: #FFF469;\n        --ft-green: #4ECDC4;\n        --ft-gray: #2A2A2A;\n        --ft-gray-light: #3A3A3A;\n        --ft-gray-muted: #6B6B6B;\n      }\n\n      * {\n        margin: 0;\n        padding: 0;\n        box-sizing: border-box;\n      }\n\n      body {\n        font-family: 'Helvetica Neue', Arial, sans-serif;\n        background-color: var(--ft-black);\n        color: var(--ft-white);\n        line-height: 1.6;\n        min-height: 100vh;\n      }\n\n      .container {\n        max-width: 800px;\n        margin: 0 auto;\n        padding: 40px 20px;\n      }\n\n      /* Header */\n      .tool-header {\n        text-align: center;\n        margin-bottom: 48px;\n        padding-bottom: 32px;\n        border-bottom: 1px solid var(--ft-gray-light);\n      }\n\n      .tool-header h1 {\n        font-size: 2.5rem;\n        font-weight: 700;\n        text-transform: uppercase;\n        letter-spacing: 2px;\n        margin-bottom: 16px;\n      }\n\n      .tool-header .tagline {\n        font-size: 1.25rem;\n        color: var(--ft-gray-muted);\n        font-weight: 400;\n      }\n\n      /* Progress Bar */\n      .progress-container {\n        margin-bottom: 40px;\n      }\n\n      .progress-bar {\n        height: 4px;\n        background: var(--ft-gray-light);\n        border-radius: 2px;\n        overflow: hidden;\n      }\n\n      .progress-fill {\n        height: 100%;\n        background: var(--ft-green);\n        width: 0%;\n        transition: width 0.3s ease;\n      }\n\n      .progress-text {\n        display: flex;\n        justify-content: space-between;\n        margin-top: 8px;\n        font-size: 0.875rem;\n        color: var(--ft-gray-muted);\n      }\n\n      /* Sections */\n      .section {\n        margin-bottom: 48px;\n      }\n\n      .section-title {\n        font-size: 0.875rem;\n        text-transform: uppercase;\n        letter-spacing: 3px;\n        color: var(--ft-gray-muted);\n        margin-bottom: 24px;\n      }\n\n      /* Content from Markdown */\n      .content h1, .content h2, .content h3 {\n        margin-top: 32px;\n        margin-bottom: 16px;\n      }\n\n      .content h1 { font-size: 2rem; }\n      .content h2 { font-size: 1.5rem; color: var(--ft-white); }\n      .content h3 { font-size: 1.125rem; color: var(--ft-gray-muted); }\n\n      .content p {\n        margin-bottom: 16px;\n        color: #CCCCCC;\n      }\n\n      .content ul, .content ol {\n        margin-left: 24px;\n        margin-bottom: 16px;\n      }\n\n      .content li {\n        margin-bottom: 8px;\n        color: #CCCCCC;\n      }\n\n      /* Form Elements */\n      .input-group {\n        margin-bottom: 32px;\n      }\n\n      .input-label {\n        display: block;\n        font-size: 1rem;\n        font-weight: 600;\n        margin-bottom: 12px;\n        color: var(--ft-white);\n      }\n\n      .input-description {\n        font-size: 0.875rem;\n        color: var(--ft-gray-muted);\n        margin-bottom: 12px;\n      }\n\n      input[type=\"text\"],\n      input[type=\"number\"],\n      input[type=\"email\"],\n      select,\n      textarea {\n        width: 100%;\n        padding: 16px;\n        font-size: 1rem;\n        background: var(--ft-gray);\n        border: 2px solid var(--ft-gray-light);\n        border-radius: 8px;\n        color: var(--ft-white);\n        transition: border-color 0.2s ease;\n      }\n\n      input:focus,\n      select:focus,\n      textarea:focus {\n        outline: none;\n        border-color: var(--ft-green);\n      }\n\n      /* Slider */\n      .slider-container {\n        padding: 16px 0;\n      }\n\n      input[type=\"range\"] {\n        width: 100%;\n        height: 8px;\n        -webkit-appearance: none;\n        background: var(--ft-gray-light);\n        border-radius: 4px;\n        outline: none;\n      }\n\n      input[type=\"range\"]::-webkit-slider-thumb {\n        -webkit-appearance: none;\n        width: 24px;\n        height: 24px;\n        background: var(--ft-green);\n        border-radius: 50%;\n        cursor: pointer;\n      }\n\n      .slider-labels {\n        display: flex;\n        justify-content: space-between;\n        margin-top: 8px;\n        font-size: 0.75rem;\n        color: var(--ft-gray-muted);\n      }\n\n      .slider-value {\n        text-align: center;\n        font-size: 2rem;\n        font-weight: 700;\n        color: var(--ft-green);\n        margin-top: 16px;\n      }\n\n      /* Buttons */\n      .btn {\n        display: inline-block;\n        padding: 16px 32px;\n        font-size: 1rem;\n        font-weight: 600;\n        text-transform: uppercase;\n        letter-spacing: 1px;\n        border: none;\n        border-radius: 8px;\n        cursor: pointer;\n        transition: all 0.2s ease;\n      }\n\n      .btn-primary {\n        background: var(--ft-green);\n        color: var(--ft-black);\n      }\n\n      .btn-primary:hover {\n        background: #3DBDB5;\n        transform: translateY(-2px);\n      }\n\n      .btn-secondary {\n        background: transparent;\n        color: var(--ft-white);\n        border: 2px solid var(--ft-gray-light);\n      }\n\n      .btn-secondary:hover {\n        border-color: var(--ft-white);\n      }\n\n      .btn-group {\n        display: flex;\n        gap: 16px;\n        margin-top: 32px;\n      }\n\n      /* Yes/No Buttons */\n      .yesno-group {\n        display: flex;\n        gap: 16px;\n      }\n\n      .yesno-btn {\n        flex: 1;\n        padding: 20px;\n        font-size: 1.125rem;\n        font-weight: 600;\n        background: var(--ft-gray);\n        border: 2px solid var(--ft-gray-light);\n        border-radius: 8px;\n        color: var(--ft-white);\n        cursor: pointer;\n        transition: all 0.2s ease;\n      }\n\n      .yesno-btn:hover {\n        border-color: var(--ft-white);\n      }\n\n      .yesno-btn.selected {\n        border-color: var(--ft-green);\n        background: rgba(78, 205, 196, 0.1);\n      }\n\n      /* Feedback */\n      .feedback {\n        margin-top: 16px;\n        padding: 16px;\n        border-radius: 8px;\n        font-size: 0.875rem;\n        display: none;\n      }\n\n      .feedback.show {\n        display: block;\n      }\n\n      .feedback.low {\n        background: rgba(255, 107, 107, 0.1);\n        border-left: 4px solid var(--ft-red);\n        color: var(--ft-red);\n      }\n\n      .feedback.mid {\n        background: rgba(255, 244, 105, 0.1);\n        border-left: 4px solid var(--ft-yellow);\n        color: var(--ft-yellow);\n      }\n\n      .feedback.high {\n        background: rgba(78, 205, 196, 0.1);\n        border-left: 4px solid var(--ft-green);\n        color: var(--ft-green);\n      }\n\n      /* Verdict Section */\n      .verdict {\n        text-align: center;\n        padding: 48px;\n        border-radius: 16px;\n        margin-top: 48px;\n        display: none;\n      }\n\n      .verdict.show {\n        display: block;\n      }\n\n      .verdict.low {\n        background: linear-gradient(135deg, rgba(255, 107, 107, 0.2), rgba(255, 107, 107, 0.05));\n        border: 2px solid var(--ft-red);\n      }\n\n      .verdict.mid {\n        background: linear-gradient(135deg, rgba(255, 244, 105, 0.2), rgba(255, 244, 105, 0.05));\n        border: 2px solid var(--ft-yellow);\n      }\n\n      .verdict.high {\n        background: linear-gradient(135deg, rgba(78, 205, 196, 0.2), rgba(78, 205, 196, 0.05));\n        border: 2px solid var(--ft-green);\n      }\n\n      .verdict-score {\n        font-size: 4rem;\n        font-weight: 700;\n        margin-bottom: 16px;\n      }\n\n      .verdict.low .verdict-score { color: var(--ft-red); }\n      .verdict.mid .verdict-score { color: var(--ft-yellow); }\n      .verdict.high .verdict-score { color: var(--ft-green); }\n\n      .verdict-title {\n        font-size: 1.5rem;\n        font-weight: 700;\n        text-transform: uppercase;\n        margin-bottom: 16px;\n      }\n\n      .verdict-message {\n        font-size: 1.125rem;\n        color: #CCCCCC;\n        margin-bottom: 24px;\n      }\n\n      .verdict-action {\n        font-size: 1rem;\n        font-weight: 600;\n        padding: 16px 24px;\n        background: var(--ft-gray);\n        border-radius: 8px;\n        display: inline-block;\n      }\n\n      /* Commitment Section */\n      .commitment-section {\n        background: var(--ft-gray);\n        padding: 32px;\n        border-radius: 16px;\n        margin-top: 32px;\n        display: none;\n      }\n\n      .commitment-section.show {\n        display: block;\n      }\n\n      .commitment-section h3 {\n        font-size: 1.25rem;\n        margin-bottom: 24px;\n        color: var(--ft-white);\n      }\n\n      /* Share Buttons */\n      .share-section {\n        margin-top: 32px;\n        padding-top: 32px;\n        border-top: 1px solid var(--ft-gray-light);\n      }\n\n      .share-buttons {\n        display: flex;\n        gap: 12px;\n        flex-wrap: wrap;\n      }\n\n      .share-btn {\n        padding: 12px 20px;\n        font-size: 0.875rem;\n        background: var(--ft-gray-light);\n        border: none;\n        border-radius: 6px;\n        color: var(--ft-white);\n        cursor: pointer;\n        transition: background 0.2s ease;\n      }\n\n      .share-btn:hover {\n        background: var(--ft-gray-muted);\n      }\n\n      /* Steps Navigation */\n      .step {\n        display: none;\n      }\n\n      .step.active {\n        display: block;\n      }\n\n      .step-nav {\n        display: flex;\n        justify-content: space-between;\n        margin-top: 40px;\n        padding-top: 24px;\n        border-top: 1px solid var(--ft-gray-light);\n      }\n\n      /* Fast Track Branding */\n      .ft-brand {\n        text-align: center;\n        margin-top: 64px;\n        padding-top: 32px;\n        border-top: 1px solid var(--ft-gray-light);\n        color: var(--ft-gray-muted);\n        font-size: 0.875rem;\n      }\n\n      .ft-brand a {\n        color: var(--ft-green);\n        text-decoration: none;\n      }\n    </style>\n  </head>\n  <body>\n    <div class=\"container\">\n      <!-- Tool Header -->\n      <div class=\"tool-header\">\n        <h1>{{ $('Parse Revised Markdown').item.json.tool_name }}</h1>\n        <p class=\"tagline\">{{ $('Parse Revised Markdown').item.json.meta.tagline || 'Make better decisions, faster.' }}</p>\n      </div>\n\n      <!-- Progress -->\n      <div class=\"progress-container\">\n        <div class=\"progress-bar\">\n          <div class=\"progress-fill\" id=\"progressFill\"></div>\n        </div>\n        <div class=\"progress-text\">\n          <span id=\"progressStep\">Step 1</span>\n          <span id=\"progressPercent\">0%</span>\n        </div>\n      </div>\n\n      <!-- Main Content from Markdown -->\n      <div class=\"content\">\n        {{ $('MD to HTML - Revision').item.json.html }}\n      </div>\n\n      <!-- Verdict Display -->\n      <div class=\"verdict\" id=\"verdictDisplay\">\n        <div class=\"verdict-score\" id=\"verdictScore\">0</div>\n        <div class=\"verdict-title\" id=\"verdictTitle\">YOUR VERDICT</div>\n        <div class=\"verdict-message\" id=\"verdictMessage\">Complete all inputs to see your result.</div>\n        <div class=\"verdict-action\" id=\"verdictAction\"></div>\n      </div>\n\n      <!-- Commitment Section -->\n      <div class=\"commitment-section\" id=\"commitmentSection\">\n        <h3>Lock In Your Decision</h3>\n        <div class=\"input-group\">\n          <label class=\"input-label\">What will you do by when?</label>\n          <textarea id=\"commitmentText\" rows=\"3\" placeholder=\"I will...\"></textarea>\n        </div>\n        <div class=\"input-group\">\n          <label class=\"input-label\">Deadline</label>\n          <input type=\"date\" id=\"commitmentDeadline\">\n        </div>\n        <div class=\"share-section\">\n          <label class=\"input-label\">Share your commitment</label>\n          <div class=\"share-buttons\">\n            <button class=\"share-btn\" onclick=\"shareCommitment('team')\">My Team</button>\n            <button class=\"share-btn\" onclick=\"shareCommitment('manager')\">My Manager</button>\n            <button class=\"share-btn\" onclick=\"shareCommitment('coach')\">My Coach</button>\n            <button class=\"share-btn\" onclick=\"shareCommitment('email')\">Email</button>\n          </div>\n        </div>\n      </div>\n\n      <!-- Branding -->\n      <div class=\"ft-brand\">\n        Built with <a href=\"https://fasttrack.co\" target=\"_blank\">Fast Track</a>\n      </div>\n    </div>\n\n    <script>\n      // Tool State\n      const state = {\n        inputs: {},\n        currentStep: 1,\n        totalSteps: 3,\n        score: 0\n      };\n\n      // Initialize\n      document.addEventListener('DOMContentLoaded', function() {\n        initializeInputs();\n        updateProgress();\n      });\n\n      function initializeInputs() {\n        // Number inputs\n        document.querySelectorAll('input[type=\"number\"]').forEach(input => {\n          input.addEventListener('change', handleInputChange);\n        });\n\n        // Range/slider inputs\n        document.querySelectorAll('input[type=\"range\"]').forEach(input => {\n          input.addEventListener('input', function() {\n            handleInputChange.call(this);\n            updateSliderDisplay(this);\n          });\n        });\n\n        // Select inputs\n        document.querySelectorAll('select').forEach(select => {\n          select.addEventListener('change', handleInputChange);\n        });\n\n        // Text inputs\n        document.querySelectorAll('input[type=\"text\"], textarea').forEach(input => {\n          input.addEventListener('input', handleInputChange);\n        });\n      }\n\n      function handleInputChange() {\n        const id = this.id || this.name;\n        const value = this.value;\n        state.inputs[id] = value;\n\n        showFeedback(id, value);\n        calculateScore();\n        updateProgress();\n      }\n\n      function updateSliderDisplay(slider) {\n        const display = slider.parentElement.querySelector('.slider-value');\n        if (display) {\n          display.textContent = slider.value;\n        }\n      }\n\n      function showFeedback(inputId, value) {\n        const feedbackEl = document.getElementById(inputId + '-feedback');\n        if (!feedbackEl) return;\n\n        const numValue = parseFloat(value) || 0;\n        const max = parseFloat(document.getElementById(inputId)?.max) || 100;\n        const percent = (numValue / max) * 100;\n\n        feedbackEl.classList.remove('low', 'mid', 'high');\n        feedbackEl.classList.add('show');\n\n        if (percent <= 30) {\n          feedbackEl.classList.add('low');\n          feedbackEl.textContent = feedbackEl.dataset.low || 'Needs attention';\n        } else if (percent <= 70) {\n          feedbackEl.classList.add('mid');\n          feedbackEl.textContent = feedbackEl.dataset.mid || 'Getting there';\n        } else {\n          feedbackEl.classList.add('high');\n          feedbackEl.textContent = feedbackEl.dataset.high || 'Strong position';\n        }\n      }\n\n      function calculateScore() {\n        const inputs = Object.values(state.inputs).filter(v => v !== '');\n        if (inputs.length === 0) {\n          state.score = 0;\n          return;\n        }\n\n        // Simple average calculation - customize based on tool\n        let total = 0;\n        let count = 0;\n\n        for (const [key, value] of Object.entries(state.inputs)) {\n          const numValue = parseFloat(value);\n          if (!isNaN(numValue)) {\n            const input = document.getElementById(key);\n            const max = parseFloat(input?.max) || 100;\n            total += (numValue / max) * 100;\n            count++;\n          }\n        }\n\n        state.score = count > 0 ? Math.round(total / count) : 0;\n        updateVerdict();\n      }\n\n      function updateProgress() {\n        const inputs = document.querySelectorAll('input, select, textarea');\n        const filled = Array.from(inputs).filter(i => i.value !== '').length;\n        const percent = Math.round((filled / inputs.length) * 100);\n\n        document.getElementById('progressFill').style.width = percent + '%';\n        document.getElementById('progressPercent').textContent = percent + '%';\n      }\n\n      function updateVerdict() {\n        const verdictEl = document.getElementById('verdictDisplay');\n        const scoreEl = document.getElementById('verdictScore');\n        const titleEl = document.getElementById('verdictTitle');\n        const messageEl = document.getElementById('verdictMessage');\n        const actionEl = document.getElementById('verdictAction');\n        const commitmentEl = document.getElementById('commitmentSection');\n\n        verdictEl.classList.remove('low', 'mid', 'high');\n        verdictEl.classList.add('show');\n\n        scoreEl.textContent = state.score;\n\n        if (state.score <= 35) {\n          verdictEl.classList.add('low');\n          titleEl.textContent = 'ACTION REQUIRED';\n          messageEl.textContent = 'Your situation needs immediate attention.';\n          actionEl.textContent = 'Take action this week';\n        } else if (state.score <= 65) {\n          verdictEl.classList.add('mid');\n          titleEl.textContent = 'OPTIMIZE FIRST';\n          messageEl.textContent = 'Room for improvement before major decisions.';\n          actionEl.textContent = 'Review and optimize within 30 days';\n        } else {\n          verdictEl.classList.add('high');\n          titleEl.textContent = 'STRONG POSITION';\n          messageEl.textContent = 'You have a solid foundation to build on.';\n          actionEl.textContent = 'Plan your next growth phase';\n        }\n\n        // Show commitment section when score is calculated\n        if (state.score > 0) {\n          commitmentEl.classList.add('show');\n        }\n      }\n\n      function selectYesNo(group, value) {\n        const buttons = document.querySelectorAll(`[data-group=\"${group}\"]`);\n        buttons.forEach(btn => btn.classList.remove('selected'));\n        event.target.classList.add('selected');\n\n        state.inputs[group] = value;\n        showFeedback(group, value === 'yes' ? 100 : 0);\n        calculateScore();\n        updateProgress();\n      }\n\n      function shareCommitment(platform) {\n        const commitment = document.getElementById('commitmentText').value;\n        const deadline = document.getElementById('commitmentDeadline').value;\n        const score = state.score;\n\n        const message = `My commitment: ${commitment}\\nDeadline: ${deadline}\\nScore: ${score}/100`;\n\n        if (platform === 'email') {\n          window.location.href = `mailto:?subject=My Fast Track Commitment&body=${encodeURIComponent(message)}`;\n        } else {\n          alert(`Sharing to ${platform}:\\n\\n${message}`);\n        }\n      }\n\n      function nextStep() {\n        if (state.currentStep < state.totalSteps) {\n          document.querySelector(`.step-${state.currentStep}`).classList.remove('active');\n          state.currentStep++;\n          document.querySelector(`.step-${state.currentStep}`).classList.add('active');\n          document.getElementById('progressStep').textContent = `Step ${state.currentStep}`;\n        }\n      }\n\n      function prevStep() {\n        if (state.currentStep > 1) {\n          document.querySelector(`.step-${state.currentStep}`).classList.remove('active');\n          state.currentStep--;\n          document.querySelector(`.step-${state.currentStep}`).classList.add('active');\n          document.getElementById('progressStep').textContent = `Step ${state.currentStep}`;\n        }\n      }\n    </script>\n  </body>\n  </html>"
      },
      "type": "n8n-nodes-base.html",
      "typeVersion": 1.2,
      "position": [
        2800,
        1504
      ],
      "id": "1247e46d-4e73-40ea-b99a-9736680a0c78",
      "name": "Build Revised HTML"
    },
    {
      "parameters": {
        "jsCode": "// Parse Revised Markdown from Revision Agent\n  const prevData = $('Prepare Retry').first().json;\n  const markdown = $('Revision Agent 0').first().json.output || '';\n\n  // Extract metadata\n  const metaMatch = markdown.match(/===TOOL_META===([\\s\\S]*?)===END_META===/);\n  let meta = {};\n  if (metaMatch) {\n    metaMatch[1].split('\\n').forEach(line => {\n      const [key, ...rest] = line.split(':');\n      if (key && rest.length) {\n        meta[key.trim()] = rest.join(':').trim();\n      }\n    });\n  }\n\n  // Extract sections\n  const sections = {};\n  const sectionPatterns = [\n    ['cover', /===COVER===([\\s\\S]*?)===END_COVER===/],\n    ['context', /===CONTEXT===([\\s\\S]*?)===END_CONTEXT===/],\n    ['commitment', /===COMMITMENT===([\\s\\S]*?)===END_COMMITMENT===/],\n    ['verdicts', /===VERDICTS===([\\s\\S]*?)===END_VERDICTS===/],\n    ['scoring', /===SCORING===([\\s\\S]*?)===END_SCORING===/]\n  ];\n\n  sectionPatterns.forEach(([name, pattern]) => {\n    const match = markdown.match(pattern);\n    if (match) sections[name] = match[1].trim();\n  });\n\n  // Count inputs and feedback\n  const inputCount = (markdown.match(/### INPUT:\\d+\\.\\d+/g) || []).length;\n  const feedbackCount = (markdown.match(/### FEEDBACK:\\d+\\.\\d+/g) || []).length;\n\n  // Parse verdicts\n  const verdictCount = (markdown.match(/### SCORE \\d+-\\d+/g) || []).length;\n\n  return [{\n    json: {\n      job_id: prevData.job_id,\n      attempt: prevData.attempt,\n      max_attempts: prevData.max_attempts,\n      callback_url: prevData.callback_url,\n      tool_name: meta.tool_name || prevData.tool_name || 'Unnamed Tool',\n      tool_slug: meta.tool_slug || 'unnamed-tool',\n      meta,\n      sections,\n      inputs: { count: inputCount },\n      feedback: { count: feedbackCount },\n      verdicts: new Array(verdictCount).fill({}),\n      raw_markdown: markdown\n    }\n  }];"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        2512,
        1264
      ],
      "id": "77532826-c69b-4f26-8bca-d4f9977d88d5",
      "name": "Parse Revised Markdown1"
    },
    {
      "parameters": {
        "jsCode": "// Merge parsed data with built HTML for QA validation\n  const parsed = $('Parse Markdown Sections').first().json;\n  const html = $('Build HTML Template').first().json.html;\n\n  return [{\n    json: {\n      ...parsed,\n      tool_html: html\n    }\n  }];"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        1376,
        640
      ],
      "id": "c35d2696-6a16-4eeb-a288-6818e0d996ab",
      "name": "Merge for QA"
    },
    {
      "parameters": {
        "jsCode": "// Merge revised parsed data with built HTML for QA validation\n  const parsed = $('Parse Revised Markdown1').first().json;\n  const html = $('Build Revised HTML').first().json.html;\n\n  return [{\n    json: {\n      ...parsed,\n      tool_html: html\n    }\n  }];"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        2816,
        1760
      ],
      "id": "1402ee2f-7a4c-4a0a-ae95-9ae23fc218f6",
      "name": "Merge for QA - Revision"
    },
    {
      "parameters": {
        "collection": "tool_example",
        "options": {
          "limit": 1
        },
        "query": "={ \"passed_qa\": true }"
      },
      "type": "n8n-nodes-base.mongoDb",
      "typeVersion": 1.2,
      "position": [
        -592,
        1280
      ],
      "id": "e2fae6f8-8793-4e6f-88be-7d960cf41e04",
      "name": "MongoDB - Tool Example",
      "credentials": {
        "mongoDb": {
          "id": "g6FogqsZFxtd6Brl",
          "name": "tools system"
        }
      }
    }
  ],
  "connections": {
    "tool-factory": {
      "main": [
        [
          {
            "node": "Parse & Normalize Input",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Tool Architect Agent": {
      "main": [
        [
          {
            "node": "Parse Markdown Sections",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Google Gemini Chat Model": {
      "ai_languageModel": [
        [
          {
            "node": "Tool Architect Agent",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Markdown to HTML": {
      "main": [
        [
          {
            "node": "Build HTML Template",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Build HTML Template": {
      "main": [
        [
          {
            "node": "Merge for QA",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "If": {
      "main": [
        [
          {
            "node": "Insert documents",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Prepare Retry",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Insert documents": {
      "main": [
        [
          {
            "node": "Respond to Webhook",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Merge Context": {
      "main": [
        [
          {
            "node": "Tool Architect Agent",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "MongoDB - Brand Guidelines": {
      "main": [
        [
          {
            "node": "MongoDB - 8 Point Criteria",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "MongoDB - Writing Guide": {
      "main": [
        [
          {
            "node": "MongoDB - Tool Example",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "MongoDB - 8 Point Criteria": {
      "main": [
        [
          {
            "node": "MongoDB - Writing Guide",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Parse Markdown Sections": {
      "main": [
        [
          {
            "node": "Markdown to HTML",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "QA Validator": {
      "main": [
        [
          {
            "node": "If",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Prepare Retry": {
      "main": [
        [
          {
            "node": "Revision Agent 0",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Parse & Normalize Input": {
      "main": [
        [
          {
            "node": "MongoDB - Brand Guidelines",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Google Gemini Chat Model1": {
      "ai_languageModel": [
        [
          {
            "node": "Revision Agent 0",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Revision Agent 0": {
      "main": [
        [
          {
            "node": "Parse Revised Markdown1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "MD to HTML - Revision": {
      "main": [
        [
          {
            "node": "Build Revised HTML",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Build Revised HTML": {
      "main": [
        [
          {
            "node": "Merge for QA - Revision",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Parse Revised Markdown1": {
      "main": [
        [
          {
            "node": "MD to HTML - Revision",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Merge for QA": {
      "main": [
        [
          {
            "node": "QA Validator",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Merge for QA - Revision": {
      "main": [
        [
          {
            "node": "QA Validator",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "MongoDB - Tool Example": {
      "main": [
        [
          {
            "node": "Merge Context",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "pinData": {
    "tool-factory": [
      {
        "headers": {
          "host": "n8n-edge.fasttrack-diagnostic.com",
          "user-agent": "curl/8.17.0",
          "content-length": "902",
          "accept": "*/*",
          "content-type": "application/json",
          "x-forwarded-for": "78.154.13.138",
          "x-forwarded-host": "n8n-edge.fasttrack-diagnostic.com",
          "x-forwarded-port": "443",
          "x-forwarded-proto": "https",
          "x-forwarded-server": "076e68a27b6f",
          "x-real-ip": "78.154.13.138",
          "accept-encoding": "gzip"
        },
        "params": {},
        "query": {},
        "body": {
          "job_id": "test-008",
          "source": {
            "text": "Create a Hiring Decision Tool. The CEO needs to decide: Should I hire a new team member or optimize my current team first? The user will learn how to objectively assess team capacity and make data-driven hiring decisions. Inputs needed: current team size (number 1-50), average hours worked per week (number 30-80), team stress level (slider 1-10), deadlines missed last quarter (number 0-20), skill gaps identified (yes/no). Scoring: HIGH score (70-100) means team is maxed out and hiring is urgent. MEDIUM (40-69) means some optimization possible but start recruiting. LOW (0-39) means optimize current team before hiring."
          },
          "callback_url": "https://webhook.site/test-callback",
          "metadata": {
            "original_filename": "hiring-decision-request.md",
            "file_type": "MD",
            "file_size_bytes": 650,
            "submitted_at": "2026-01-27T10:30:00.000Z"
          }
        },
        "webhookUrl": "n8n-edge.fasttrack-diagnostic.com/webhook/tool-factory",
        "executionMode": "production"
      }
    ]
  },
  "meta": {
    "templateCredsSetupCompleted": true,
    "instanceId": "51f038016172110edf8b4016b318fd229a876eea5ef46b51b740d7167ba1dfb4"
  }
}z